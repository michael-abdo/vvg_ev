exports.id=2244,exports.ids=[2244],exports.modules={28303:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=28303,e.exports=t},35845:(e,t,r)=>{"use strict";async function a(e){console.log(`Text extraction for document ${e} - customize per project`)}async function i(e,t){console.log("\uD83E\uDD16 [COMPARE] Starting document comparison...");let r=e.text.split(/\s+/),a=t.text.split(/\s+/);return{differences:[{section:"Document Length",standardText:`${r.length} words`,thirdPartyText:`${a.length} words`,severity:Math.abs(r.length-a.length)>100?"medium":"low",suggestion:"Consider reviewing document length differences"}],summary:`Document comparison completed. Standard: ${r.length} words, Third-party: ${a.length} words.`}}function n(e){let t=e.split(/\s+/).filter(e=>e.length>0),r=e.split(/[.!?]+/).filter(e=>e.trim().length>0),a=e.split(/\n\n+/).filter(e=>e.trim().length>0);return{words:t.length,characters:e.length,charactersNoSpaces:e.replace(/\s/g,"").length,sentences:r.length,paragraphs:a.length,averageWordLength:t.length>0?Math.round(t.reduce((e,t)=>e+t.length,0)/t.length*10)/10:0}}function s(e){let t=[],r=e.match(/^\d+\.\s*[A-Z][^.]*$/gm);r&&t.push(...r.map(e=>e.trim()));let a=e.match(/^[A-Z][A-Z\s]{2,}$/gm);return a&&t.push(...a.map(e=>e.trim())),["WHEREAS","THEREFORE","ARTICLE","SECTION","CLAUSE"].forEach(r=>{let a=e.match(RegExp(`^.*${r}.*$`,"gmi"));a&&t.push(...a.map(e=>e.trim()))}),[...new Set(t)]}function o(e,t){let r=new Set(e.toLowerCase().split(/\s+/).filter(e=>e.length>3)),a=new Set(t.toLowerCase().split(/\s+/).filter(e=>e.length>3)),i=new Set([...r].filter(e=>a.has(e))),n=new Set([...r].filter(e=>!a.has(e))),s=new Set([...a].filter(e=>!r.has(e))),o=new Set([...r,...a]);return{score:o.size>0?i.size/o.size*100:0,commonWords:i,uniqueToText1:n,uniqueToText2:s}}r.d(t,{Kd:()=>s,OD:()=>i,Qr:()=>o,ZX:()=>n,processTextExtraction:()=>a}),r(27075)},63188:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var a=r(27075);let i={parsePagination:e=>{let t=a.k0.pagination(e);return{page:t.page,pageSize:t.pageSize,offset:t.offset}},parseDocumentFilters:e=>{let t=e.get("type");return{type:"standard"===t||"third_party"===t?t:void 0,search:e.get("search")||""}},parseComparisonRequest:async e=>{let t=await e.json(),r=a.k0.documentId(t.standardDocId||t.doc1Id||t.document1Id),i=a.k0.documentId(t.thirdPartyDocId||t.doc2Id||t.document2Id);if(!r.isValid||!i.isValid)throw Error("Invalid document IDs provided");return{doc1Id:r.value,doc2Id:i.value}},parseDocumentId:e=>{let t=a.k0.documentId(e);return t.isValid?t.value:null},parseDocumentUpdateRequest:async e=>{let t=await e.json(),r=a.B7.validateString(t.display_name,{required:!1,trim:!0,fieldName:"display_name",maxLength:255}),i=a.B7.validateBoolean(t.is_standard,{fieldName:"is_standard"}),n={};if(void 0!==t.display_name){if(!r.isValid)throw Error(r.error);n.display_name=r.value||null}if(void 0!==t.is_standard){if(!i.isValid)throw Error(i.error);n.is_standard=i.value}if(0===Object.keys(n).length)throw Error("No valid updates provided");return n},parseStatsFilters:e=>({period:e.get("period")||"7d",includeHistory:"true"===e.get("includeHistory")}),parseUploadRequest:async e=>{let t=await e.formData(),r=t.get("file"),i="true"===t.get("isStandard"),n=a.AF.safeParse(t.get("metadata"),{});if(!r)throw Error("No file provided in upload request");return{file:r,isStandard:i,metadata:n}},parseQueryParams:(e,t)=>{let r={};return Object.entries(t).forEach(([t,a])=>{let i=e.get(t);if(null===i)r[t]=a.default;else{let e=a.parse?a.parse(i):i;a.validate&&!a.validate(e)?r[t]=a.default:r[t]=e}}),r},extractUserContext:(e,t)=>({userEmail:e,timestamp:a.ag.now(),userAgent:t?.get("userAgent")||"unknown",sessionId:t?.get("sessionId")||null}),validateRequiredFields:(e,t)=>{let r=t.filter(t=>void 0===e[t]||null===e[t]||""===e[t]);if(r.length>0)throw Error(`Missing required fields: ${r.join(", ")}`)}}},93213:(e,t,r)=>{"use strict";r.d(t,{YW:()=>E});var a=r(46101),i=r(81571),n=r(45740);let s=a.createPool({host:i.$W.MYSQL_HOST,port:parseInt(i.$W.MYSQL_PORT),user:i.$W.MYSQL_USER,password:i.$W.MYSQL_PASSWORD,database:i.$W.MYSQL_DATABASE,waitForConnections:!0,connectionLimit:10,queueLimit:0});async function o({query:e,values:t=[]}){let r=Date.now(),a=e.split(" ")[0].toUpperCase(),o=function(e){for(let t of[/FROM\s+`?(\w+)`?/i,/INSERT\s+INTO\s+`?(\w+)`?/i,/UPDATE\s+`?(\w+)`?/i,/DELETE\s+FROM\s+`?(\w+)`?/i]){let r=e.match(t);if(r&&r[1])return r[1]}return"unknown"}(e);try{let l;if(e.includes("LIMIT ?")){let r=await s.getConnection();try{let[a]=await r.query(e,t);l=a}finally{r.release()}}else{let[r]=await s.execute(e,t);l=r}let d=Date.now()-r,u=Array.isArray(l)?l.length:void 0!==l.affectedRows?l.affectedRows:0;return(0,n.kF)(a,o,d,{rowCount:u,query:i.$W.IS_DEVELOPMENT?e:void 0,values:i.$W.IS_DEVELOPMENT?t:void 0}),l}catch(l){let s=Date.now()-r;throw(0,n.kF)(a,o,s,{error:!0,errorMessage:l instanceof Error?l.message:String(l),query:i.$W.IS_DEVELOPMENT?e:void 0,values:i.$W.IS_DEVELOPMENT?t:void 0}),l instanceof Error&&(0,n.vV)(l,{type:"database",operation:a,table:o,query:i.$W.IS_DEVELOPMENT?e:void 0}),l}}i.$W.MYSQL_HOST&&i.$W.MYSQL_DATABASE&&console.log("MySQL connection pool created with config:",{host:i.$W.MYSQL_HOST,port:i.$W.MYSQL_PORT,user:i.$W.MYSQL_USER,database:i.$W.MYSQL_DATABASE,connectionLimit:10});var l=r(27075);let d=i.$W.DB_CREATE_ACCESS||!1;async function u(e,t){try{return await e()}catch(r){let e=`Database ${t.operation} failed for ${t.entity}`;if(console.error(e,{message:r instanceof Error?r.message:"Unknown error",operation:t.operation,entity:t.entity,details:t.details}),r instanceof Error){if(r.message.includes("ECONNREFUSED")||r.message.includes("Connection"))throw Error(`Database connection failed: ${t.operation} ${t.entity}`);if(r.message.includes("Duplicate")||r.message.includes("duplicate"))throw Error(`Duplicate ${t.entity} found`);if(r.message.includes("foreign key constraint"))throw Error(`Cannot ${t.operation} ${t.entity}: referenced data exists`)}throw Error(e)}}class c{constructor(e){this.config=e}async safeQuery(e,t,r,a){return u(()=>o({query:e,values:t}),{operation:r,entity:this.config.entityName,details:{query:e.slice(0,100),userId:a}})}async create(e){if(d){let t=Object.keys(e),r=t.map(t=>this.prepareValue(e[t],t)),a=t.map(()=>"?").join(", "),i=`
        INSERT INTO ${this.config.tableName} (${t.join(", ")})
        VALUES (${a})
      `,n=await this.safeQuery(i,r,"create",e.user_id),s=await this.findById(n.insertId);if(!s)throw Error(`Failed to retrieve created ${this.config.entityName}`);return s}{let t=this.config.nextId(),r=l.ag.parse(l.ag.now()),a={...e,id:t,created_at:r,updated_at:r};return this.config.memoryStore.set(t,a),a}}async findById(e){if(!d)return this.config.memoryStore.get(e)||null;{let t=await this.safeQuery(`SELECT * FROM ${this.config.tableName} WHERE id = ?`,[e],"findById");return t.length>0?this.config.rowConverter(t[0]):null}}async findByUser(e,t){if(d){let r=`SELECT * FROM ${this.config.tableName} WHERE user_id = ?`,a=[e];return t?.orderBy&&(r+=" ORDER BY "+t.orderBy.map(e=>`${e.column} ${e.order}`).join(", ")),t?.limit&&(r+=" LIMIT ?",a.push(t.limit),t.offset&&(r+=" OFFSET ?",a.push(t.offset))),(await this.safeQuery(r,a,"findByUser",e)).map(e=>this.config.rowConverter(e))}{let r=Array.from(this.config.memoryStore.values()).filter(t=>t.user_id===e);if(t?.orderBy&&r.sort((e,r)=>{let a=t.orderBy[0],i=e[a.column],n=r[a.column];return"ASC"===a.order?i>n?1:-1:i<n?1:-1}),t?.limit){let e=t.offset||0;r=r.slice(e,e+t.limit)}return r}}async update(e,t){if(d){let r=Object.keys(t).filter(e=>"id"!==e&&"created_at"!==e);if(0===r.length)return!1;let a=r.map(e=>this.prepareValue(t[e],e));a.push(l.ag.now()),a.push(e);let i=`
        UPDATE ${this.config.tableName} 
        SET ${r.map(e=>`${e} = ?`).join(", ")}, updated_at = ?
        WHERE id = ?
      `;return(await this.safeQuery(i,a,"update")).affectedRows>0}{let r=this.config.memoryStore.get(e);return!!r&&(Object.assign(r,t,{updated_at:l.ag.parse(l.ag.now())}),!0)}}async delete(e){return d?(await this.safeQuery(`DELETE FROM ${this.config.tableName} WHERE id = ?`,[e],"delete")).affectedRows>0:this.config.memoryStore.delete(e)}prepareValue(e,t){return void 0===e?null:"metadata"===t&&e&&"object"==typeof e?JSON.stringify(e):e}async executeCustomQuery(e,t,r,a){return this.safeQuery(e,t,r,a)}async findByField(e,t,r,a=`findBy${e}`){if(d){let r=await this.executeCustomQuery(`SELECT * FROM ${this.config.tableName} WHERE ${e} = ?`,[t],a);return r.length>0?this.config.rowConverter(r[0]):null}for(let e of this.config.memoryStore.values())if(r(e))return e;return null}async findByFields(e,t,r="findByFields",a){if(d){let t=Object.keys(e),i=Object.values(e),n=t.map(e=>`${e} = ?`).join(" AND "),s=a?` LIMIT ${a}`:"";return(await this.executeCustomQuery(`SELECT * FROM ${this.config.tableName} WHERE ${n}${s}`,i,r)).map(e=>this.config.rowConverter(e))}{let e=Array.from(this.config.memoryStore.values()).filter(e=>t(e));return a&&(e=e.slice(0,a)),e}}async findFirstByField(e,t,r,a=`findFirstBy${e}`){let i=await this.findByFields({[e]:t},r,a,1);return i.length>0?i[0]:null}}var f=r(22547);function m(e){return{...e,file_size:Number(e.file_size),metadata:l.AF.safeParse(e.metadata,null)}}class p extends c{constructor(){global._templateMemoryStore||(global._templateMemoryStore={documents:new Map,comparisons:new Map,exports:new Map,queue:new Map,nextId:{documents:1,comparisons:1,exports:1,queue:1}}),super({tableName:"documents",entityName:"document",rowConverter:m,memoryStore:global._templateMemoryStore.documents,nextId:()=>global._templateMemoryStore.nextId.documents++})}async findByHash(e){return this.findByField("file_hash",e,t=>t.file_hash===e,"findByHash")}async getStandardDocument(e){return this.findFirstByField("user_id",e,t=>t.user_id===e&&t.is_standard,"getStandardDocument")}async findByStatus(e,t){let r={status:e};return t&&(r.user_id=t),this.findByFields(r,r=>{let a=r.status===e,i=!t||r.user_id===t;return a&&i},"findByStatus")}async create(e){let t={...e,status:e.status||f.Ai.UPLOADED,is_standard:e.is_standard||!1,extracted_text:e.extracted_text||null,metadata:e.metadata||null};return super.create(t)}}function y(e){return{...e,similarity_score:e.similarity_score?parseFloat(e.similarity_score):null,key_differences:e.key_differences?JSON.parse(e.key_differences):[],ai_suggestions:e.ai_suggestions?JSON.parse(e.ai_suggestions):[]}}class g extends c{constructor(){global._templateMemoryStore||(global._templateMemoryStore={documents:new Map,comparisons:new Map,exports:new Map,queue:new Map,nextId:{documents:1,comparisons:1,exports:1,queue:1}}),super({tableName:"comparisons",entityName:"comparison",rowConverter:y,memoryStore:global._templateMemoryStore.comparisons,nextId:()=>global._templateMemoryStore.nextId.comparisons++})}async findByStatus(e,t){let r={status:e};return t&&(r.user_id=t),this.findByFields(r,r=>{let a=r.status===e,i=!t||r.user_id===t;return a&&i},"findByStatus")}async findByDocuments(e,t,r){return this.findFirstByField("document1_id",e,a=>{let i=a.document1_id===e&&a.document2_id===t||a.document1_id===t&&a.document2_id===e,n=!r||a.user_id===r;return i&&n},"findByDocuments")}}let h=new p;new g;let E=h}};