(()=>{var e={};e.id=6402,e.ids=[6402],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10022:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},17537:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Mike/Desktop/programming/3_current_projects/other/vvg/vvg_template/app/compare/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Mike/Desktop/programming/3_current_projects/other/vvg/vvg_template/app/compare/page.tsx","default")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23959:(e,t,r)=>{Promise.resolve().then(r.bind(r,17537))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34664:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>L});var s=r(60687),a=r(43210),o=r(24120),n=r(62688);let i=(0,n.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,n.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),c=(0,n.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var d=r(64398),u=r(10022);let m=(0,n.A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var p=r(68008),h=r(36784);let g={resolved:function(){let e=function(e){if(!e||""===e||"/"===e)return"";let t=e.trim();return t.startsWith("/")||(t=`/${t}`),t.endsWith("/")&&t.length>1&&(t=t.slice(0,-1)),t}(process.env.BASE_PATH||"/template-staging");return function(e){if(""!==e){if(!e.startsWith("/"))throw Error(`BasePath must start with '/'. Got: ${e}`);if(e.endsWith("/"))throw Error(`BasePath must NOT end with '/'. Got: ${e}`);if(/[^a-zA-Z0-9\-_\/]/.test(e))throw Error(`BasePath contains invalid characters. Use only: a-z, A-Z, 0-9, -, _, /. Got: ${e}`);if(e.includes("//"))throw Error(`BasePath cannot contain double slashes. Got: ${e}`);if(e.length>100)throw Error(`BasePath too long (max 100 chars). Got: ${e.length} chars`)}}(e),""===e&&console.warn(`⚠️ [BasePath] Production running at root path (no basePath)`),e}(),utilities:null};g.utilities=function(e){return{basePath:e,buildPagePath:t=>{if(t.startsWith("http"))return t;let r=t.startsWith("/")?t:`/${t}`;return`${e}${r}`},buildApiPath:t=>{if(t.startsWith("http"))return t;let r=t.startsWith("/api/")?t:`/api/${t.replace(/^\//,"")}`;return`${e}${r}`},buildAssetPath:t=>{if(t.startsWith("http"))return t;let r=t.startsWith("/")?t:`/${t}`;return`${e}${r}`},stripBasePath:t=>e&&t.startsWith(e)?t.slice(e.length)||"/":t}}(g.resolved),g.resolved;let E={AZURE_AD_CLIENT_ID:process.env.AZURE_AD_CLIENT_ID||"",AZURE_AD_CLIENT_SECRET:process.env.AZURE_AD_CLIENT_SECRET||"",AZURE_AD_TENANT_ID:process.env.AZURE_AD_TENANT_ID||"",NEXTAUTH_URL:process.env.NEXTAUTH_URL||`http://localhost:${process.env.PORT}`,NEXTAUTH_SECRET:process.env.NEXTAUTH_SECRET||"fallback-secret-for-build",BASE_PATH:g.resolved,DB_TABLE_PREFIX:process.env.DB_TABLE_PREFIX||"",NODE_ENV:"production",OPENAI_API_KEY:process.env.OPENAI_API_KEY||"",QUEUE_SYSTEM_TOKEN:process.env.QUEUE_SYSTEM_TOKEN||"development-queue-token",IS_DEVELOPMENT:!1,IS_PRODUCTION:!0,MYSQL_HOST:process.env.MYSQL_HOST||"localhost",MYSQL_PORT:process.env.MYSQL_PORT||"3306",MYSQL_USER:process.env.MYSQL_USER||"root",MYSQL_PASSWORD:process.env.MYSQL_PASSWORD||"",MYSQL_DATABASE:process.env.MYSQL_DATABASE||"vvg_template",DATABASE_URL:process.env.DATABASE_URL||"",STORAGE_PROVIDER:process.env.STORAGE_PROVIDER||"local",AWS_ACCESS_KEY_ID:process.env.AWS_ACCESS_KEY_ID||"",AWS_SECRET_ACCESS_KEY:process.env.AWS_SECRET_ACCESS_KEY||"",AWS_REGION:process.env.AWS_REGION||"us-west-2",S3_BUCKET_NAME:process.env.S3_BUCKET_NAME||"vvg-template-shared-bucket",S3_FOLDER_PREFIX:process.env.S3_FOLDER_PREFIX||"documents/",S3_ACCESS:"true"===process.env.S3_ACCESS,app:{name:process.env.PROJECT_NAME||"vvg-template",email:process.env.SES_FROM_EMAIL||"noreply@example.com"},email:{smtp:{host:process.env.AWS_SES_SMTP_HOST||`email-smtp.${process.env.AWS_REGION||"us-east-1"}.amazonaws.com`,port:parseInt(process.env.AWS_SES_SMTP_PORT||"587",10),username:process.env.AWS_SES_SMTP_USERNAME||"",password:process.env.AWS_SES_SMTP_PASSWORD||""},from:process.env.SES_FROM_EMAIL||"noreply@example.com",testRecipient:process.env.SES_TEST_RECIPIENT||"",adminEmail:process.env.ADMIN_EMAIL||"",enableInDev:"true"===process.env.ENABLE_EMAIL_IN_DEV}},S={isDevelopment:()=>"development"===E.NODE_ENV,isProduction:()=>"production"===E.NODE_ENV,isTest:()=>"test"===E.NODE_ENV,isStaging:()=>"staging"===E.NODE_ENV,requireDevelopment:()=>{if(S.isProduction())throw Error("Development-only feature accessed in production")},devOnlyResponse:()=>S.isProduction()?new Response(null,{status:404}):null,hasDbAccess:()=>!!(E.DATABASE_URL||E.MYSQL_HOST&&E.MYSQL_DATABASE)},f={DEV_BYPASS:"false"!==process.env.FEATURE_DEV_BYPASS,devBypass:"false"!==process.env.FEATURE_DEV_BYPASS};({...E,basePath:{resolved:g.resolved,utilities:g.utilities}});let _={FILE_LIMITS:{ALLOWED_MIME_TYPES:["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain","text/csv"],ALLOWED_EXTENSIONS:[".pdf",".docx",".doc",".txt",".csv"],MAX_SIZE:0xa00000}};E.NODE_ENV,S.isDevelopment(),S.isProduction(),process.env.QUEUE_SYSTEM_TOKEN;var x=function(e){return e.UPLOADED="uploaded",e.PROCESSING="processing",e.PROCESSED="processed",e.ERROR="error",e}({}),y=function(e){return e.PENDING="pending",e.PROCESSING="processing",e.COMPLETED="completed",e.ERROR="error",e}({});x.UPLOADED,x.PROCESSING,x.ERROR,x.PROCESSING,x.PROCESSED,x.ERROR,x.PROCESSED,x.ERROR,x.PROCESSING,y.PENDING,y.PROCESSING,y.ERROR,y.PROCESSING,y.COMPLETED,y.ERROR,y.COMPLETED,y.ERROR,y.PROCESSING;class R{constructor(e,t={}){this.startTime=Date.now(),this.operationName=e,this.metadata=t}elapsed(){return Date.now()-this.startTime}elapsedFormatted(){return this.formatDuration(this.elapsed())}end(){let e=Date.now(),t=e-this.startTime;return{startTime:new Date(this.startTime),endTime:new Date(e),duration:t,durationMs:t,durationFormatted:this.formatDuration(t),operationName:this.operationName}}endWithLog(e={}){let t=this.end(),{logger:r,threshold:s=0,level:a="log"}=e;if(t.duration>=s){let e=`${this.operationName} completed in ${t.durationFormatted}`,s={duration:t.duration,startTime:t.startTime.toISOString(),endTime:t.endTime.toISOString(),...this.metadata};r?r[a](e,s):console[a](`[PERFORMANCE] ${e}`,s)}return t}formatDuration(e){return e<1e3?`${e}ms`:e<6e4?`${(e/1e3).toFixed(2)}s`:e<36e5?`${(e/6e4).toFixed(2)}m`:`${(e/36e5).toFixed(2)}h`}}let v={isFileNotFoundError:e=>e?.code==="ENOENT"||e?.code==="NoSuchKey"||e?.message?.includes("not found")||e?.statusCode===404,isDatabaseConnectionError:e=>e?.code==="ECONNREFUSED"||e?.code==="ER_CON_COUNT_ERROR"||e?.message?.includes("connection refused"),isDuplicateError:e=>e?.code==="ER_DUP_ENTRY"||e?.code==="23505"||e?.message?.includes("duplicate"),getErrorCategory(e){return this.isFileNotFoundError(e)?"not_found":this.isDatabaseConnectionError(e)?"connection":this.isDuplicateError(e)?"duplicate":e?.code==="AccessDenied"||e?.code==="Forbidden"?"permission":e?.code?.startsWith("ER_")||e?.name==="ValidationError"?"validation":"unknown"},getErrorSuggestion(e,t={}){let r=e.code||e.Code||"UNKNOWN_ERROR",s=e.statusCode||e.$metadata?.httpStatusCode;switch(r){case"NoSuchBucket":return{userMessage:"Storage bucket not found",errorCode:"STORAGE_BUCKET_NOT_FOUND",isRetryable:!1,suggestion:"Please check your storage configuration and bucket name."};case"AccessDenied":case"Forbidden":return{userMessage:"Storage access denied",errorCode:"STORAGE_ACCESS_DENIED",isRetryable:!1,suggestion:"Please check your storage credentials and bucket permissions."};case"NoSuchKey":return{userMessage:t.resource?`File '${t.resource}' not found in storage`:"File not found in storage",errorCode:"STORAGE_FILE_NOT_FOUND",isRetryable:!1,suggestion:"The requested file may have been moved or deleted."};case"InvalidBucketName":return{userMessage:"Invalid storage bucket name",errorCode:"STORAGE_INVALID_BUCKET",isRetryable:!1,suggestion:"Please check your storage configuration for valid bucket naming."};case"SlowDown":case"RequestLimitExceeded":case"TooManyRequests":return{userMessage:"Storage service is being throttled",errorCode:"STORAGE_THROTTLED",isRetryable:!0,suggestion:"Please wait a moment and try again. The service is experiencing high load."};case"ServiceUnavailable":return{userMessage:"Storage service temporarily unavailable",errorCode:"STORAGE_SERVICE_UNAVAILABLE",isRetryable:!0,suggestion:"The storage service is temporarily down. Please try again in a few minutes."};case"RequestTimeout":return{userMessage:"Storage operation timed out",errorCode:"STORAGE_TIMEOUT",isRetryable:!0,suggestion:"The operation took too long to complete. Please try again."};case"ENOSPC":return{userMessage:"Insufficient storage space",errorCode:"STORAGE_QUOTA_EXCEEDED",isRetryable:!1,suggestion:"Please free up storage space or contact your administrator."};case"ENOENT":return{userMessage:"File or directory not found",errorCode:"STORAGE_PATH_NOT_FOUND",isRetryable:!1,suggestion:"The file path may be incorrect or the file may have been moved."};case"ECONNREFUSED":return{userMessage:"Cannot connect to storage service",errorCode:"STORAGE_CONNECTION_REFUSED",isRetryable:!0,suggestion:"Please check your network connection and storage service configuration."};case"ETIMEDOUT":return{userMessage:"Connection to storage service timed out",errorCode:"STORAGE_CONNECTION_TIMEOUT",isRetryable:!0,suggestion:"Please check your network connection and try again."};case"ENOTFOUND":return{userMessage:"Storage service not found",errorCode:"STORAGE_SERVICE_NOT_FOUND",isRetryable:!0,suggestion:"Please check your storage service configuration and DNS settings."};default:if(s){if(s>=500&&s<600)return{userMessage:"Storage service error",errorCode:"STORAGE_SERVER_ERROR",isRetryable:!0,suggestion:"A server error occurred. Please try again in a few moments."};if(s>=400&&s<500)return{userMessage:"Storage request error",errorCode:"STORAGE_CLIENT_ERROR",isRetryable:!1,suggestion:"Please check your request parameters and try again."}}return{userMessage:t.operation?`${t.operation} operation failed`:"Storage operation failed",errorCode:"STORAGE_UNKNOWN_ERROR",isRetryable:!1,suggestion:"An unexpected error occurred. Please try again or contact support."}}},isRetryableError(e){return this.getErrorSuggestion(e).isRetryable},getUserMessage(e,t={}){return this.getErrorSuggestion(e,t).userMessage},getErrorCode(e){return this.getErrorSuggestion(e).errorCode},getSuggestion(e,t={}){return this.getErrorSuggestion(e,t).suggestion}},w={storage:{maxAttempts:3,initialDelay:1e3,maxDelay:1e4,backoffFactor:2,jitter:!0,timeout:3e4},api:{maxAttempts:3,initialDelay:500,maxDelay:5e3,backoffFactor:2,jitter:!0,timeout:15e3},database:{maxAttempts:5,initialDelay:100,maxDelay:2e3,backoffFactor:1.5,jitter:!1,timeout:1e4},queue:{maxAttempts:3,initialDelay:2e3,maxDelay:3e4,backoffFactor:2,jitter:!0,timeout:6e4},network:{maxAttempts:5,initialDelay:1e3,maxDelay:8e3,backoffFactor:2,jitter:!0,timeout:2e4}};class N{constructor(e=5,t=6e4){this.failureThreshold=e,this.recoveryTimeout=t,this.failures=0,this.lastFailureTime=0,this.state="closed"}canExecute(){return"closed"===this.state||"open"!==this.state||Date.now()-this.lastFailureTime>this.recoveryTimeout&&(this.state="half-open",!0)}onSuccess(){this.failures=0,this.state="closed"}onFailure(){this.failures++,this.lastFailureTime=Date.now(),this.failures>=this.failureThreshold&&(this.state="open")}getState(){return this.state}}class T{static{this.circuitBreakers=new Map}static async withRetry(e,t={}){let{maxAttempts:r=3,initialDelay:s=1e3,maxDelay:a=1e4,backoffFactor:o=2,jitter:n=!0,timeout:i,retryCondition:l=this.defaultRetryCondition,onRetry:c,onFailure:d,abortSignal:u}=t,m=new R("retry-operation"),p=[],h=0;for(;h<r;){h++;try{if(u?.aborted)throw Error("Operation aborted");let t=i?await this.withTimeout(e(),i):await e(),r=m.end();return{result:t,attempts:h,totalDuration:r.duration,errors:p,wasRetried:h>1}}catch(u){let e=u instanceof Error?u:Error(String(u));if(p.push(e),h>=r||!l(e,h)){let t=m.end();throw d&&d(e,h,t.duration),Error(`Operation failed after ${h} attempts in ${t.durationFormatted}. Last error: ${e.message}`)}let t=Math.min(s*Math.pow(o,h-1),a),i=n?t+Math.random()*t*.1:t;c&&c(e,h,i),await this.delay(i)}}throw Error("Unexpected retry loop exit")}static defaultRetryCondition(e,t){return v.isRetryableError(e)}static async withCircuitBreaker(e,t,r={}){let s=this.getCircuitBreaker(t);if(!s.canExecute())throw Error(`Circuit breaker is open for ${t}`);try{let t=await this.withRetry(e,r);return s.onSuccess(),t}catch(e){throw s.onFailure(),e}}static getCircuitBreaker(e){return this.circuitBreakers.has(e)||this.circuitBreakers.set(e,new N),this.circuitBreakers.get(e)}static async forStorage(e,t,r={}){return this.withRetry(e,{...w.storage,...r,onRetry:(e,s,a)=>{console.log(`Storage ${t} failed (attempt ${s}), retrying in ${a}ms:`,e.message),r.onRetry?.(e,s,a)},onFailure:(e,s,a)=>{console.error(`Storage ${t} failed permanently after ${s} attempts in ${a}ms:`,e),r.onFailure?.(e,s,a)}})}static async forApi(e,t,r={}){return this.withRetry(e,{...w.api,...r,retryCondition:(e,t)=>e.status>=400&&e.status<500?408===e.status||429===e.status:this.defaultRetryCondition(e,t),onRetry:(e,s,a)=>{console.log(`API ${t} failed (attempt ${s}), retrying in ${a}ms:`,e.message),r.onRetry?.(e,s,a)}})}static async forDatabase(e,t,r={}){return this.withRetry(e,{...w.database,...r,retryCondition:(e,t)=>{let r=e.message?.toLowerCase()||"";return!!(r.includes("connection")||r.includes("timeout")||r.includes("deadlock"))||this.defaultRetryCondition(e,t)},onRetry:(e,s,a)=>{console.log(`Database ${t} failed (attempt ${s}), retrying in ${a}ms:`,e.message),r.onRetry?.(e,s,a)}})}static async forQueue(e,t,r={}){return this.withRetry(e,{...w.queue,...r,onRetry:(e,s,a)=>{console.log(`Queue ${t} failed (attempt ${s}), retrying in ${a}ms:`,e.message),r.onRetry?.(e,s,a)}})}static async withConfig(e,t,r={}){return this.withRetry(e,{...w[t],...r})}static withTimeout(e,t){return new Promise((r,s)=>{let a=setTimeout(()=>{s(Error(`Operation timed out after ${t}ms`))},t);e.then(r).catch(s).finally(()=>clearTimeout(a))})}static delay(e){return new Promise(t=>setTimeout(t,e))}static async retryAll(e,t={}){return Promise.all(e.map(e=>this.withRetry(e,t)))}static async withRateLimit(e,t,r={}){return this.withRetry(e,{...r,retryCondition:(e,t)=>e.message?.includes("rate limit")?t<(r.maxAttempts||5):r.retryCondition?.(e,t)??this.defaultRetryCondition(e,t)})}static getCircuitBreakerStatus(e){let t=this.circuitBreakers.get(e);return t?.getState()||"unknown"}static resetCircuitBreaker(e){this.circuitBreakers.delete(e)}static getAllCircuitBreakerStatuses(){let e={};for(let[t,r]of this.circuitBreakers)e[t]=r.getState();return e}}class D{static sanitize(e){let t=b.getMessage(e),r=b.getCode(e);return{message:t.replace(/password[=:]\s*[^\s]+/gi,"password=***").replace(/token[=:]\s*[^\s]+/gi,"token=***").replace(/key[=:]\s*[^\s]+/gi,"key=***"),code:r,timestamp:P.now(),sanitized:!0}}static toUserMessage(e){return b.isError(e)?"An error occurred. Please try again.":"An unexpected error occurred."}static normalizeError(e){return b.isError(e)?e:Error("string"==typeof e?e:"Unknown error")}}D.sanitize,D.normalizeError,D.toUserMessage;class A{static convertBaseRow(e){return{...e,created_at:"string"==typeof e.created_at?new Date(e.created_at):e.created_at,updated_at:"string"==typeof e.updated_at?new Date(e.updated_at):e.updated_at}}static convertDocument(e){return{...A.convertBaseRow(e),metadata:I.parseMetadata(e.metadata),file_size:Number(e.file_size),is_standard:!!e.is_standard}}static convertComparison(e){return{...A.convertBaseRow(e),metadata:I.parseMetadata(e.metadata),differences:I.parseMetadata(e.differences),risk_score:Number(e.risk_score),document_id:Number(e.document_id),standard_id:e.standard_id?Number(e.standard_id):null}}static convertExport(e){return{...A.convertBaseRow(e),metadata:I.parseMetadata(e.metadata),comparison_id:Number(e.comparison_id)}}static convertQueue(e){return{...A.convertBaseRow(e),metadata:I.parseMetadata(e.metadata),document_id:Number(e.document_id),priority:Number(e.priority),attempts:Number(e.attempts),max_attempts:Number(e.max_attempts),scheduled_at:e.scheduled_at?"string"==typeof e.scheduled_at?new Date(e.scheduled_at):e.scheduled_at:null,started_at:e.started_at?"string"==typeof e.started_at?new Date(e.started_at):e.started_at:null,completed_at:e.completed_at?"string"==typeof e.completed_at?new Date(e.completed_at):e.completed_at:null,failed_at:e.failed_at?"string"==typeof e.failed_at?new Date(e.failed_at):e.failed_at:null}}}A.convertDocument,A.convertComparison,A.convertExport,A.convertQueue,(e,t)=>e.map(t);let C={badRequest:e=>h.NextResponse.json({error:e},{status:400}),validation:(e,t)=>h.NextResponse.json({error:e,details:t},{status:422})},O={getFilenameFromPath:e=>e.split("/").pop()||e,getFileExtension:e=>e.toLowerCase().split(".").pop()||"",getFileType:e=>O.getFileExtension(e)||"unknown",containsIgnoreCase:(e,t)=>e.toLowerCase().includes(t.toLowerCase()),normalize:e=>e.toLowerCase().trim(),formatFileSize:e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},formatDate:e=>new Date(e).toLocaleDateString(),getTextStats:e=>{if(!e)return{length:0,words:0,lines:0,paragraphs:0,isEmpty:!0,hasContent:!1};let t=e.trim(),r=t.split(/\s+/).filter(e=>e.length>0),s=t.split("\n").filter(e=>e.trim().length>0),a=t.split(/\n\n+/).filter(e=>e.trim().length>0);return{length:e.length,words:r.length,lines:s.length,paragraphs:a.length,isEmpty:0===t.length,hasContent:t.length>0}},truncate:(e,t,r="...")=>!e||e.length<=t?e:e.substring(0,t-r.length).trim()+r,extractPreview:(e,t=200)=>{if(!e)return"";let r=e.replace(/\s+/g," ").trim();return O.truncate(r,t)},calculateSimilarity:(e,t)=>{if(!e||!t)return 0;let r=new Set(e.toLowerCase().split(/\s+/)),s=new Set(t.toLowerCase().split(/\s+/)),a=new Set([...r].filter(e=>s.has(e))),o=new Set([...r,...s]);return o.size>0?a.size/o.size:0}},b={isError:e=>e instanceof Error||e&&"object"==typeof e&&"message"in e&&"name"in e,getMessage:e=>"string"==typeof e?e:b.isError(e)?e.message:e?.error?b.getMessage(e.error):e?.message?e.message:"Unknown error occurred",getCode:e=>e?.code||e?.errorCode||e?.error_code,withContext:(e,t)=>{let r=Error(e);return Object.assign(r,{context:t}),r},isType:(e,t)=>e?.name===t||e?.constructor?.name===t,is:{networkError:e=>{let t=b.getMessage(e).toLowerCase();return t.includes("network")||t.includes("fetch")||t.includes("connection")},validationError:e=>{let t=b.getMessage(e).toLowerCase();return t.includes("validation")||t.includes("invalid")||e?.statusCode===422},authError:e=>{let t=b.getMessage(e).toLowerCase();return t.includes("unauthorized")||t.includes("authentication")||e?.statusCode===401},notFoundError:e=>b.getMessage(e).toLowerCase().includes("not found")||e?.statusCode===404}};function M(e){return O.getFilenameFromPath(e)}let j={allowedTypes:[..._.FILE_LIMITS.ALLOWED_MIME_TYPES],allowedExtensions:_.FILE_LIMITS.ALLOWED_EXTENSIONS,maxSize:_.FILE_LIMITS.MAX_SIZE,extensionToMimeType:{".pdf":"application/pdf",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".doc":"application/msword",".txt":"text/plain",".csv":"text/csv"},validateFile:e=>{if(!j.allowedTypes.includes(e.type))throw Error(`Invalid file type. Only ${j.allowedExtensions.join(", ").toUpperCase()} files are allowed. Received: ${e.type}`);if(e.size>j.maxSize)throw Error(`File too large. Maximum size is ${j.maxSize/1024/1024}MB. Received: ${(e.size/1024/1024).toFixed(2)}MB`);return!0},getValidationError:e=>{try{return j.validateFile(e),null}catch(t){if(t.message.includes("Invalid file type"))return C.validation("Invalid file type",{allowedTypes:j.allowedExtensions,receivedType:e.type});if(t.message.includes("File too large"))return C.validation("File too large",{maxSize:j.maxSize,actualSize:e.size,maxSizeMB:j.maxSize/1024/1024,actualSizeMB:Number((e.size/1024/1024).toFixed(2))});return C.badRequest(t.message)}},getContentType:e=>{let t=e.toLowerCase().split(".").pop()||"";return j.extensionToMimeType[t]||"application/octet-stream"}},P={now:()=>new Date().toISOString(),nowUTC:()=>new Date().toISOString(),formatForDB:(e=new Date)=>e.toISOString(),formatForLog:(e=new Date)=>e.toISOString(),formatForAPI:(e=new Date)=>e.toISOString(),createTimestamp:()=>({createdAt:P.now()}),updateTimestamp:()=>({updatedAt:P.now()}),auditTimestamp:()=>({createdAt:P.now(),updatedAt:P.now()}),withMetadata:e=>({timestamp:P.now(),...e}),parse:e=>e instanceof Date?e:new Date(e),isRecent:(e,t=5)=>{let r=P.parse(e);return(new Date().getTime()-r.getTime())/6e4<=t},formatHuman:(e=new Date,t="en-US")=>e.toLocaleString(t),toLocaleDateString:(e,t="en-US")=>new Date(e).toLocaleDateString(t,{year:"numeric",month:"short",day:"numeric"}),toLocaleString:(e,t="en-US")=>new Date(e).toLocaleString(t),fromNow:e=>{let t=Math.floor((Date.now()-new Date(e).getTime())/864e5);return 0===t?"Today":1===t?"Yesterday":t<7?`${t} days ago`:t<30?`${Math.floor(t/7)} weeks ago`:P.toLocaleDateString(e)},isExpired:e=>new Date(e).getTime()<Date.now(),formatForFilename:(e=new Date)=>e.toISOString().replace(/[:.]/g,"-").split(".")[0],duration:{seconds:(e,t=new Date)=>{let r=P.parse(e);return Math.floor((P.parse(t).getTime()-r.getTime())/1e3)},minutes:(e,t=new Date)=>Math.floor(P.duration.seconds(e,t)/60),milliseconds:(e,t=new Date)=>{let r=P.parse(e);return P.parse(t).getTime()-r.getTime()},humanReadable:(e,t=new Date)=>{let r=P.duration.milliseconds(e,t);return r<1e3?`${r}ms`:r<6e4?`${(r/1e3).toFixed(1)}s`:r<36e5?`${(r/6e4).toFixed(1)}m`:`${(r/36e5).toFixed(1)}h`}},relative:{from:(e,t=new Date)=>{let r=P.parse(e),s=t.getTime()-r.getTime();return s<6e4?"just now":s<36e5?`${Math.floor(s/6e4)} minutes ago`:s<864e5?`${Math.floor(s/36e5)} hours ago`:s<6048e5?`${Math.floor(s/864e5)} days ago`:r.toLocaleDateString()},to:(e,t=new Date)=>{let r=P.parse(e),s=r.getTime()-t.getTime();return s<0?P.relative.from(e,t):s<6e4?"in a moment":s<36e5?`in ${Math.floor(s/6e4)} minutes`:s<864e5?`in ${Math.floor(s/36e5)} hours`:s<6048e5?`in ${Math.floor(s/864e5)} days`:r.toLocaleDateString()}}},I={safeParse:(e,t)=>{if(!e)return t;try{return JSON.parse(e)}catch{return t}},parseMetadata:e=>e?"string"==typeof e?I.safeParse(e,{}):e:{},mergeMetadata:(e,t)=>({...I.parseMetadata(e),...t,lastUpdated:new Date().toISOString()}),stringify:(e,t=!1)=>{try{return t?JSON.stringify(e,null,2):JSON.stringify(e)}catch(e){return console.error("JSON stringify error:",e),"{}"}},deepClone:e=>JSON.parse(JSON.stringify(e)),isValidJson:e=>{try{return JSON.parse(e),!0}catch{return!1}},extractFields:(e,t)=>{let r=I.parseMetadata(e),s={};return t.forEach(e=>{e in r&&(s[e]=r[e])}),s},metadata:{withTimestamp:e=>({...e,timestamp:new Date().toISOString()}),withUser:(e,t)=>({...e,userEmail:t,updatedBy:t,updatedAt:new Date().toISOString()}),withError:(e,t)=>({...e,error:{message:t.message,name:t.name,timestamp:new Date().toISOString()}})},getNestedValue:(e,t,r)=>{if(!e)return r;let s=t.split("."),a=e;for(let e of s){if(a?.[e]===void 0)return r;a=a[e]}return a},getExtractionMetadata:e=>({pages:I.getNestedValue(e,"extraction.pages",null),confidence:I.getNestedValue(e,"extraction.confidence",null),method:I.getNestedValue(e,"extraction.method","unknown"),extractedAt:I.getNestedValue(e,"extraction.extractedAt",null)})};var k=r(97096);function L(){let[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)(""),[h,g]=(0,a.useState)(null),[E,S]=(0,a.useState)([]),{data:f=[]}=(0,k.KS)("/api/documents",{autoLoad:!1,transform:e=>e.data||[],deps:[]}),{execute:_,loading:x}=(0,k.FE)({onSuccess:e=>{g(e.data),S(t=>[e.data,...t.slice(0,4)])},onError:e=>{alert(`Comparison failed: ${e.message}`)}}),y=(e,t)=>_(async()=>{let r=await fetch("/api/compare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({standardDocId:e,thirdPartyDocId:t})});if(!r.ok)throw Error((await r.json()).message||"Comparison failed");return r.json()}),R=async()=>{e&&r&&(g(null),await y(e,r))},v=f?.filter(e=>e.is_standard)||[],w=f?.filter(e=>!e.is_standard)||[],N=e=>{switch(e){case"low":return"text-green-600 bg-green-50 border-green-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"high":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return(0,s.jsxs)(p.L,{className:"space-y-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Compare Documents"}),(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Select Documents to Compare"})}),(0,s.jsxs)(o.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Standard Template"}),(0,s.jsxs)(o.l6,{value:e,onValueChange:t,children:[(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Choose your standard document template"})}),(0,s.jsx)(o.gC,{children:v.map(e=>(0,s.jsx)(o.eb,{value:e.id.toString(),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.A,{className:"h-3 w-3 text-yellow-500"}),M(e.filename)]})},e.id))})]}),0===v.length&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"No standard templates found. Upload a document and mark it as standard in the Documents page."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Third-Party Document"}),(0,s.jsxs)(o.l6,{value:r,onValueChange:n,children:[(0,s.jsx)(o.bq,{children:(0,s.jsx)(o.yv,{placeholder:"Choose third-party document to analyze"})}),(0,s.jsx)(o.gC,{children:w.map(e=>(0,s.jsx)(o.eb,{value:e.id.toString(),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-3 w-3"}),M(e.filename)]})},e.id))})]}),0===w.length&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"No third-party documents found. Upload some documents to compare."})]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(o.$n,{onClick:R,disabled:!e||!r||x,size:"lg",className:"px-8",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing Documents..."]}):(0,s.jsxs)(s.Fragment,{children:["Compare Documents",(0,s.jsx)(m,{className:"ml-2 h-4 w-4"})]})})})]})]}),h&&(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsxs)(o.ZB,{className:"flex items-center gap-2",children:["Comparison Results",(0,s.jsxs)(o.Ex,{className:N("medium"),children:[(e=>{switch(e){case"low":return(0,s.jsx)(i,{className:"h-4 w-4"});case"medium":default:return(0,s.jsx)(l,{className:"h-4 w-4"});case"high":return(0,s.jsx)(c,{className:"h-4 w-4"})}})("medium"),"MEDIUM RISK"]})]})}),(0,s.jsxs)(o.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Executive Summary"}),(0,s.jsx)("p",{className:"text-gray-700",children:"Comparison complete. Review the differences and recommendations below."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Key Differences"}),(0,s.jsx)("ul",{className:"space-y-1",children:h.result.differences.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(c,{className:"h-4 w-4 text-amber-500 mt-0.5 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-sm",children:e.description})]},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"Detailed Analysis by Section"}),(0,s.jsx)("div",{className:"space-y-4",children:h.result.actions.slice(0,3).map((e,t)=>(0,s.jsxs)(o.Zp,{className:"border-l-4 border-l-blue-500",children:[(0,s.jsx)(o.aR,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(o.ZB,{className:"text-lg",children:e.type}),(0,s.jsx)(o.Ex,{className:N("medium"),children:"MEDIUM"})]})}),(0,s.jsx)(o.Wu,{className:"space-y-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Action:"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})})]},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Recommended Actions"}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsx)("ul",{className:"space-y-2",children:h.result.actions.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)(i,{className:"h-4 w-4 text-blue-500 mt-0.5 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-sm text-blue-800",children:e.description})]},t))})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Analysis Confidence: 85%"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Completed: ",new Date(h.created_at).toLocaleString()]})]})]})]}),E.length>0&&(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Recent Comparisons"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsx)("div",{className:"space-y-3",children:E.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>g(e),children:[(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("span",{className:"font-medium",children:["Document ",e.standard_doc_id]}),(0,s.jsx)("span",{className:"text-gray-500 mx-2",children:"vs"}),(0,s.jsxs)("span",{className:"font-medium",children:["Document ",e.third_party_doc_id]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Ex,{className:N("medium"),children:"MEDIUM"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]},t))})})]})]})}},46376:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=r(65239),a=r(48088),o=r(88170),n=r.n(o),i=r(30893),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c={children:["",{children:["compare",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,17537)),"/Users/Mike/Desktop/programming/3_current_projects/other/vvg/vvg_template/app/compare/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"/Users/Mike/Desktop/programming/3_current_projects/other/vvg/vvg_template/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/Mike/Desktop/programming/3_current_projects/other/vvg/vvg_template/app/compare/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/compare/page",pathname:"/compare",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},60751:(e,t,r)=>{Promise.resolve().then(r.bind(r,34664))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64398:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},68008:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});var s=r(60687),a=r(10660);function o({children:e,className:t}){return(0,s.jsx)("main",{className:(0,a.cn)("container mx-auto p-8",t),children:e})}},97096:(e,t,r)=>{"use strict";r.d(t,{FE:()=>o,KS:()=>a});var s=r(43210);function a(e,t={}){let[r,o]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null);return{data:r,loading:n,error:l,reload:async()=>{try{i(!0);let r=await fetch(e);if(!r.ok)throw Error(`HTTP error! status: ${r.status}`);let s=await r.json();t.transform&&(s=t.transform(s)),o(s),c(null)}catch(e){c(e.message),t.onError?.(e)}finally{i(!1)}}}}function o(e={}){let[t,r]=(0,s.useState)(!1),[a,n]=(0,s.useState)(null),[i,l]=(0,s.useState)(null);return{execute:async t=>{try{r(!0),n(null);let s=await t();return l(s),e.onSuccess?.(s),s}catch(t){throw n(t.message||"An error occurred"),e.onError?.(t),t}finally{r(!1)}},loading:t,error:a,data:i,reset:()=>{l(null),n(null),r(!1)}}}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,5727,4736,2496,4120],()=>r(46376));module.exports=s})();